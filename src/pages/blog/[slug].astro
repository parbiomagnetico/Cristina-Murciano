---
import BaseLayout from "../../layouts/BaseLayout.astro";
import Nav from "../../components/Nav.astro";
import Footer from "../../components/Footer.astro";
import posts from "../../data/posts.json";

export async function getStaticPaths() {
    return posts.map((post) => ({
        params: { slug: post.slug },
        props: { post },
    }));
}

const { post } = Astro.props;
const images = import.meta.glob<{ default: ImageMetadata }>(
    "/src/assets/images/*.png",
    { eager: true },
);
const imageSrc = images[`/src/assets/images/${post.image}`]?.default;
---

<BaseLayout title={`${post.title} | Blog`}>
    <Nav />

    <article class="pt-32 pb-20 px-6 max-w-4xl mx-auto">
        <header class="text-center mb-16">
            <span
                class="text-teal-600 font-medium tracking-widest uppercase text-sm mb-4 block"
                >{post.date}</span
            >
            <h1
                class="text-4xl md:text-6xl font-serif text-gray-900 leading-tight mb-8 text-balance"
            >
                {post.title}
            </h1>

            <div
                class="aspect-video bg-gray-200 rounded-3xl overflow-hidden relative shadow-lg"
            >
                {
                    imageSrc && (
                        <img
                            src={imageSrc.src}
                            alt={post.image_alt || post.title}
                            class="w-full h-full object-cover"
                        />
                    )
                }
            </div>
        </header>

        <div
            class="prose prose-lg prose-gray mx-auto prose-headings:font-serif prose-headings:text-gray-900 prose-a:text-teal-600 hover:prose-a:text-lilac-600 prose-img:rounded-2xl"
        >
            <p
                class="lead text-2xl text-gray-600 font-light leading-relaxed mb-8 border-l-4 border-lilac-300 pl-6"
            >
                {post.excerpt}
            </p>

            <!-- Simulating content rendering -->
            <div
                class="whitespace-pre-wrap font-light text-gray-700"
                set:html={post.content}
            />

            <hr class="border-gray-200 my-12" />

            <div
                class="bg-lilac-50 p-8 rounded-2xl flex items-center gap-6 not-prose"
            >
                <div
                    class="w-16 h-16 bg-white rounded-full flex items-center justify-center text-2xl shadow-sm"
                >
                    üë©‚Äç‚öïÔ∏è
                </div>
                <div>
                    <h4 class="font-serif text-xl text-gray-900">
                        Cristina Murciano
                    </h4>
                    <p class="text-sm text-gray-500">
                        Terapeuta Hol√≠stica y experta en bienestar natural.
                    </p>
                </div>
            </div>
        </div>

        <div class="max-w-4xl mx-auto mt-20 text-center">
            <a
                href="/blog"
                class="inline-flex items-center text-gray-500 hover:text-gray-900 font-medium transition-colors"
            >
                ‚Üê Volver al Blog
            </a>
        </div>
    </article>

    <Footer />
</BaseLayout>
